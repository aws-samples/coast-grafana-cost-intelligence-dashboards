{
  "__inputs": [
    {
      "name": "DS_GRAFANA-DASHBOARDS-CLOUDWATCH",
      "label": "grafana-dashboards-cloudwatch",
      "description": "",
      "type": "datasource",
      "pluginId": "cloudwatch",
      "pluginName": "CloudWatch"
    },
    {
      "name": "DS_GRAFANA-DASHBOARDS-ATHENA",
      "label": "grafana-dashboards-athena",
      "description": "",
      "type": "datasource",
      "pluginId": "grafana-athena-datasource",
      "pluginName": "Amazon Athena"
    }
  ],
  "__elements": {},
  "__requires": [
    {
      "type": "panel",
      "id": "barchart",
      "name": "Bar chart",
      "version": ""
    },
    {
      "type": "datasource",
      "id": "cloudwatch",
      "name": "CloudWatch",
      "version": "1.0.0"
    },
    {
      "type": "grafana",
      "id": "grafana",
      "name": "Grafana",
      "version": "10.4.1"
    },
    {
      "type": "datasource",
      "id": "grafana-athena-datasource",
      "name": "Amazon Athena",
      "version": "3.1.6"
    },
    {
      "type": "panel",
      "id": "stat",
      "name": "Stat",
      "version": ""
    },
    {
      "type": "panel",
      "id": "table",
      "name": "Table",
      "version": ""
    },
    {
      "type": "panel",
      "id": "text",
      "name": "Text",
      "version": ""
    },
    {
      "type": "panel",
      "id": "timeseries",
      "name": "Time series",
      "version": ""
    }
  ],
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "target": {
          "limit": 100,
          "matchAny": false,
          "tags": [],
          "type": "dashboard"
        },
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": null,
  "links": [
    {
      "asDropdown": false,
      "icon": "doc",
      "includeVars": false,
      "keepTime": false,
      "tags": [],
      "targetBlank": true,
      "title": "Cloudwatch Documentation",
      "tooltip": "Cloudwatch Documenatation",
      "type": "link",
      "url": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/working_with_metrics.html"
    },
    {
      "asDropdown": true,
      "icon": "external link",
      "includeVars": true,
      "keepTime": true,
      "tags": [],
      "targetBlank": true,
      "title": "Dashboards",
      "tooltip": "",
      "type": "dashboards",
      "url": ""
    }
  ],
  "liveNow": false,
  "panels": [
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 96,
      "panels": [],
      "title": "Dashboard Overview",
      "type": "row"
    },
    {
      "gridPos": {
        "h": 16,
        "w": 24,
        "x": 0,
        "y": 1
      },
      "id": 95,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "<p>\nThe Autoscaling Dashboard displays Auto Scaling group (ASG) compute cost and CloudWatch metrics.  It also displays cost and metrics for supporting \nASG resources such as a load balancer, NAT gateway and networking costs.  In order to associate ASG CloudWatch metrics with cost (from CUR) for EC2 instances launched by the ASG, \nwe use a combination of resource tags and the ASG name.  Resources associated with the ASG such as load balancers and NAT gateway should have the asg_name tag applied with the value set to the ASG name.  \n<br><br>\n<b>Tag recommendations</b>:<br>\nWe recommend having a universal tag key <i>(i.e. asg_name)</i> for all EC2 instances which are launched by the ASG.  You can set this tag in your \n<a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/create-launch-template.html\">Launch Templete</a> .  The value of this tag should be the name of the \nASG.  This tag key will also need to be enabled as a <a href=\"https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/cost-alloc-tags.html\">Cost Allocation Tag</a>.\n\n<div><h5>Section Overview</h5></div>\n<div>\n<p>\n  <ol>\n<li>Workload Cost Trends - visual displays cost for current selected time period, prior time period of same duration and the difference in cost.</li>\n<li>Compute - Compute cost and metrics for all EC2 instances in the ASG.</li>\n<li>Networking - Displays networking cost and metrics for all EC2 instances in the ASG.</li>\n<li>EBS - Displays the cost and metrics for the EBS volumes for EC2 instances (provided volumes are also tagged with the same tag).</li>\n<li>ELB - Displays the cost and metrics for the selected NAT Gateway.</li>\n<li>NAT Gateway - Displays cost and metrics for the selected NAT gateway.</li>\n</ol>\n</p>\n\n<p>\n<b>Reminder:</b> <br>\n1. For CloudWatch metrics to work correctly, you need the CloudWatch data source enabled.  For CloudWatch cross-account/cross-region to work correctly you need to have <a href=\"https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch-Unified-Cross-Account.html\" target=\"_blank\">CloudWatch (cross-account) metrics</a>\nconfigured.<br>\n2. CloudWatch metrics are available in certain visuals for the ASG.  These metrics are pulled from CloudWatch via the ASG name.  For this to work you need to enable \n<a href=\"https://docs.aws.amazon.com/autoscaling/ec2/userguide/ec2-auto-scaling-metrics.html\">Auto Scaling group metrics</a> within your ASG.<br>\n3. Change the Athena Database name and Table name in the variables section if you customized these values.  \nThe Athena Database is currently set to **${CURDatabase}**.  The Table is currently set to **${CURTable}**.\n<br><br>\nThis dashboard depends on <a href=\"https://docs.aws.amazon.com/cur/latest/userguide/table-dictionary-cur2.html\" target=\"_blank\">CUR version 2</a> and <a href=\"https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch-Unified-Cross-Account.html\" target=\"_blank\">CloudWatch (cross-account) metrics</a> being available in the data collection account.  \n\n</div>",
        "mode": "markdown"
      },
      "pluginVersion": "10.4.1",
      "title": "Auto Scaling Dashboard",
      "type": "text"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 17
      },
      "id": 28,
      "panels": [],
      "title": "Workload Cost Trends",
      "type": "row"
    },
    {
      "datasource": {
        "type": "cloudwatch",
        "uid": "${DS_GRAFANA-DASHBOARDS-CLOUDWATCH}"
      },
      "description": "",
      "gridPos": {
        "h": 2,
        "w": 24,
        "x": 0,
        "y": 18
      },
      "id": 35,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "The period over period analysis tabs will showcase cost for the selected date and time period _N_ , for N-1 period and calculate delta as a percentage.  For example if you today is Friday and you select \"Last 2 Days\" in the time period the widgets will display Friday and Thursday for the \"Selcted Time Period\".  Data for Wednesday and Tuesday for the \"Prior Time Period\" and calculate the percantage change between the two periods.  If you do not have data or tags as far bag as the prior time period, the widget will display a 0. ",
        "mode": "markdown"
      },
      "pluginVersion": "10.4.1",
      "targets": [
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_GRAFANA-DASHBOARDS-CLOUDWATCH}"
          },
          "dimensions": {},
          "expression": "",
          "id": "",
          "label": "",
          "logGroups": [],
          "matchExact": true,
          "metricEditorMode": 0,
          "metricName": "",
          "metricQueryType": 0,
          "namespace": "",
          "period": "",
          "queryMode": "Metrics",
          "refId": "A",
          "region": "$Regions",
          "sqlExpression": "",
          "statistic": "Average"
        }
      ],
      "type": "text"
    },
    {
      "datasource": {
        "type": "grafana-athena-datasource",
        "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
      },
      "description": "Compares the cost difference of the current selected time period against the prior time period (of same duration) ",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "currencyUSD"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "percent_difference"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percentunit"
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "green",
                      "value": null
                    },
                    {
                      "color": "#EAB839",
                      "value": 60
                    },
                    {
                      "color": "red",
                      "value": 80
                    }
                  ]
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 5,
        "w": 6,
        "x": 0,
        "y": 20
      },
      "id": 100,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "10.4.1",
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
          },
          "format": 1,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\n\nWITH PERIOD_HOURS_DURATION AS (\nSELECT\ndate_diff(\n  'hour', \n  $__timeFrom(line_item_usage_start_date),  \n  $__timeTo(line_item_usage_start_date)\n) as HOURS\nFROM ${CURDatabase}.${CURTable}\nLIMIT 1\n),\n  \nPRIOR_TIME_PERIOD_COST AS (\nSELECT\n  SUM(CASE\n    WHEN line_item_line_item_type = 'SavingsPlanCoveredUsage' THEN savings_plan_savings_plan_effective_cost\n    WHEN line_item_line_item_type = 'DiscountedUsage' THEN reservation_effective_cost\n    WHEN line_item_line_item_type = 'Usage' THEN line_item_unblended_cost\n    ELSE 0 \n  END) AS Cost\nFROM ${CURDatabase}.${CURTable}\nWHERE\n  line_item_usage_start_date >= $__timeFrom(line_item_usage_start_date) - (SELECT HOURS FROM PERIOD_HOURS_DURATION) * INTERVAL '1' HOUR\n  AND line_item_usage_start_date <= $__timeFrom(line_item_usage_start_date)\n  AND line_item_operation LIKE '%RunInstances%' \n  AND line_item_usage_type NOT LIKE '%DataXfer%' \n  AND product_servicecode <> 'AWSDataTransfer' \n  AND line_item_resource_id NOT LIKE 'arn:%:capacity-reservation/%'\n  AND line_item_line_item_type in ('SavingsPlanCoveredUsage', 'Usage', 'DiscountedUsage')\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\n),\n\nSELECTED_TIME_PERIOD_COST AS (\nSELECT\nSUM(CASE\n    WHEN line_item_line_item_type = 'SavingsPlanCoveredUsage' THEN savings_plan_savings_plan_effective_cost\n    WHEN line_item_line_item_type = 'DiscountedUsage' THEN reservation_effective_cost\n    WHEN line_item_line_item_type = 'Usage' THEN line_item_unblended_cost\n    ELSE 0 \n  END) AS Cost\nFROM ${CURDatabase}.${CURTable}\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AmazonEC2' \n  AND line_item_operation LIKE '%RunInstances%' \n  AND line_item_usage_type NOT LIKE '%DataXfer%' \n  AND product_servicecode <> 'AWSDataTransfer' \n  AND line_item_resource_id NOT LIKE 'arn:%:capacity-reservation/%'\n  AND line_item_line_item_type in ('SavingsPlanCoveredUsage', 'Usage', 'DiscountedUsage')\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\nLIMIT 1\n)\n\nSELECT\n(SELECT Cost FROM PRIOR_TIME_PERIOD_COST) as prior_time_period_cost,\n(SELECT Cost FROM SELECTED_TIME_PERIOD_COST) as selected_time_period_cost,\n((SELECT Cost FROM SELECTED_TIME_PERIOD_COST) -\n(SELECT Cost FROM PRIOR_TIME_PERIOD_COST)) / (SELECT Cost FROM PRIOR_TIME_PERIOD_COST) as percent_difference\n",
          "refId": "A"
        }
      ],
      "title": "Compute Cost Time Period Comparison",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-athena-datasource",
        "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
      },
      "description": "Compares the cost difference of the current selected time period against the prior time period (of same duration) ",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "noValue": "0",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "currencyUSD"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "percent_difference"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percentunit"
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "green",
                      "value": null
                    },
                    {
                      "color": "#EAB839",
                      "value": 60
                    },
                    {
                      "color": "red",
                      "value": 80
                    }
                  ]
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 5,
        "w": 6,
        "x": 6,
        "y": 20
      },
      "id": 101,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "10.4.1",
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
          },
          "format": 1,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\n\nWITH PERIOD_HOURS_DURATION AS (\nSELECT\ndate_diff(\n  'hour', \n  $__timeFrom(line_item_usage_start_date),  \n  $__timeTo(line_item_usage_start_date)\n) as HOURS\nFROM ${CURDatabase}.${CURTable}\nLIMIT 1\n),\n  \nPRIOR_TIME_PERIOD_COST AS (\nSELECT\n  SUM(CASE\n    WHEN line_item_line_item_type = 'SavingsPlanCoveredUsage' THEN savings_plan_savings_plan_effective_cost\n    WHEN line_item_line_item_type = 'DiscountedUsage' THEN reservation_effective_cost\n    WHEN line_item_line_item_type = 'Usage' THEN line_item_unblended_cost\n    ELSE 0 \n  END) AS Cost\nFROM ${CURDatabase}.${CURTable}\nWHERE\n  line_item_usage_start_date >= $__timeFrom(line_item_usage_start_date) - (SELECT HOURS FROM PERIOD_HOURS_DURATION) * INTERVAL '1' HOUR\n  AND line_item_usage_start_date <= $__timeFrom(line_item_usage_start_date)\n  AND line_item_product_code = 'AWSELB'\n  AND (line_item_usage_type LIKE '%LoadBalancerUsage' OR line_item_usage_type LIKE '%LCUUsage' OR line_item_usage_type LIKE '%NLCUUsage')\n  AND line_item_operation LIKE '%LoadBalancing%'\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\n),\n\nSELECTED_TIME_PERIOD_COST AS (\nSELECT\nSUM(CASE\n    WHEN line_item_line_item_type = 'SavingsPlanCoveredUsage' THEN savings_plan_savings_plan_effective_cost\n    WHEN line_item_line_item_type = 'DiscountedUsage' THEN reservation_effective_cost\n    WHEN line_item_line_item_type = 'Usage' THEN line_item_unblended_cost\n    ELSE 0 \n  END) AS Cost\nFROM ${CURDatabase}.${CURTable}\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AWSELB'\n  AND (line_item_usage_type LIKE '%LoadBalancerUsage' OR line_item_usage_type LIKE '%LCUUsage')\n  AND line_item_operation LIKE '%LoadBalancing%'\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\nLIMIT 1\n)\n\nSELECT\n(SELECT Cost FROM PRIOR_TIME_PERIOD_COST) as prior_time_period_cost,\n(SELECT Cost FROM SELECTED_TIME_PERIOD_COST) as selected_time_period_cost,\n((SELECT Cost FROM SELECTED_TIME_PERIOD_COST) -\n(SELECT Cost FROM PRIOR_TIME_PERIOD_COST)) / (SELECT Cost FROM PRIOR_TIME_PERIOD_COST) as percent_difference\n",
          "refId": "A"
        }
      ],
      "title": "Load Balancer Cost Time Period Comparison",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-athena-datasource",
        "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
      },
      "description": "Compares the cost difference of the current selected time period against the prior time period (of same duration) ",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "noValue": "0",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "currencyUSD"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "percent_difference"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percentunit"
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "green",
                      "value": null
                    },
                    {
                      "color": "#EAB839",
                      "value": 60
                    },
                    {
                      "color": "red",
                      "value": 80
                    }
                  ]
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 5,
        "w": 6,
        "x": 12,
        "y": 20
      },
      "id": 102,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "10.4.1",
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
          },
          "format": 1,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\n\nWITH PERIOD_HOURS_DURATION AS (\nSELECT\ndate_diff(\n  'hour', \n  $__timeFrom(line_item_usage_start_date),  \n  $__timeTo(line_item_usage_start_date)\n) as HOURS\nFROM ${CURDatabase}.${CURTable}\nLIMIT 1\n),\n  \nPRIOR_TIME_PERIOD_COST AS (\nSELECT\n  SUM(CASE\n    WHEN line_item_line_item_type = 'SavingsPlanCoveredUsage' THEN savings_plan_savings_plan_effective_cost\n    WHEN line_item_line_item_type = 'DiscountedUsage' THEN reservation_effective_cost\n    WHEN line_item_line_item_type = 'Usage' THEN line_item_unblended_cost\n    ELSE 0 \n  END) AS Cost\nFROM ${CURDatabase}.${CURTable}\nWHERE\n  line_item_usage_start_date >= $__timeFrom(line_item_usage_start_date) - (SELECT HOURS FROM PERIOD_HOURS_DURATION) * INTERVAL '1' HOUR\n  AND line_item_usage_start_date <= $__timeFrom(line_item_usage_start_date)\n  AND (line_item_product_code = 'AWSELB' OR line_item_product_code = 'AmazonEC2')\n  AND (line_item_usage_type LIKE '%-Bytes' OR line_item_usage_type = 'LCUUsage' OR line_item_usage_type = 'NLCUUsage')\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\n),\n\nSELECTED_TIME_PERIOD_COST AS (\nSELECT\nSUM(CASE\n    WHEN line_item_line_item_type = 'SavingsPlanCoveredUsage' THEN savings_plan_savings_plan_effective_cost\n    WHEN line_item_line_item_type = 'DiscountedUsage' THEN reservation_effective_cost\n    WHEN line_item_line_item_type = 'Usage' THEN line_item_unblended_cost\n    ELSE 0 \n  END) AS Cost\nFROM ${CURDatabase}.${CURTable}\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND (line_item_product_code = 'AWSELB' OR line_item_product_code = 'AmazonEC2')\n  AND (line_item_usage_type LIKE '%-Bytes' OR line_item_usage_type = 'LCUUsage' OR line_item_usage_type = 'NLCUUsage')\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\nLIMIT 1\n)\n\nSELECT\n(SELECT Cost FROM PRIOR_TIME_PERIOD_COST) as prior_time_period_cost,\n(SELECT Cost FROM SELECTED_TIME_PERIOD_COST) as selected_time_period_cost,\n((SELECT Cost FROM SELECTED_TIME_PERIOD_COST) -\n(SELECT Cost FROM PRIOR_TIME_PERIOD_COST)) / (SELECT Cost FROM PRIOR_TIME_PERIOD_COST) as percent_difference\n",
          "refId": "A"
        }
      ],
      "title": "Network Cost Time Period Comparison",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-athena-datasource",
        "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
      },
      "description": "Compares the cost difference of the current selected time period against the prior time period (of same duration) ",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "noValue": "0",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "currencyUSD"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "percent_difference"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percentunit"
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "green",
                      "value": null
                    },
                    {
                      "color": "#EAB839",
                      "value": 60
                    },
                    {
                      "color": "red",
                      "value": 80
                    }
                  ]
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 5,
        "w": 6,
        "x": 18,
        "y": 20
      },
      "id": 103,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "10.4.1",
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
          },
          "format": 1,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\n\nWITH PERIOD_HOURS_DURATION AS (\nSELECT\ndate_diff(\n  'hour', \n  $__timeFrom(line_item_usage_start_date),  \n  $__timeTo(line_item_usage_start_date)\n) as HOURS\nFROM ${CURDatabase}.${CURTable}\nLIMIT 1\n),\n  \nPRIOR_TIME_PERIOD_COST AS (\nSELECT\n  SUM(CASE\n    WHEN line_item_line_item_type = 'SavingsPlanCoveredUsage' THEN savings_plan_savings_plan_effective_cost\n    WHEN line_item_line_item_type = 'DiscountedUsage' THEN reservation_effective_cost\n    WHEN line_item_line_item_type = 'Usage' THEN line_item_unblended_cost\n    ELSE 0 \n  END) AS Cost\nFROM ${CURDatabase}.${CURTable}\nWHERE\n  line_item_usage_start_date >= $__timeFrom(line_item_usage_start_date) - (SELECT HOURS FROM PERIOD_HOURS_DURATION) * INTERVAL '1' HOUR\n  AND line_item_usage_start_date <= $__timeFrom(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2'\n  AND line_item_usage_type LIKE 'NatGateway-Hours'\n  AND line_item_operation = 'NatGateway'\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\n),\n\nSELECTED_TIME_PERIOD_COST AS (\nSELECT\nSUM(CASE\n    WHEN line_item_line_item_type = 'SavingsPlanCoveredUsage' THEN savings_plan_savings_plan_effective_cost\n    WHEN line_item_line_item_type = 'DiscountedUsage' THEN reservation_effective_cost\n    WHEN line_item_line_item_type = 'Usage' THEN line_item_unblended_cost\n    ELSE 0 \n  END) AS Cost\nFROM ${CURDatabase}.${CURTable}\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AmazonEC2'\n  AND line_item_usage_type LIKE 'NatGateway-Hours'\n  AND line_item_operation = 'NatGateway'\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\nLIMIT 1\n)\n\nSELECT\n(SELECT Cost FROM PRIOR_TIME_PERIOD_COST) as prior_time_period_cost,\n(SELECT Cost FROM SELECTED_TIME_PERIOD_COST) as selected_time_period_cost,\n((SELECT Cost FROM SELECTED_TIME_PERIOD_COST) -\n(SELECT Cost FROM PRIOR_TIME_PERIOD_COST)) / (SELECT Cost FROM PRIOR_TIME_PERIOD_COST) as percent_difference\n",
          "refId": "A"
        }
      ],
      "title": "NAT Gateway Cost Time Period Comparison",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-athena-datasource",
        "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
      },
      "description": "EC2 Compute  Cost - Cost of compute for all instances in ASG (amortized).\n\n\nLoadbalancer Cost - Cost for Load Balancer and LCUUsage.\n\n\nNetworking Cost - Cost for instance traffic, NAT Gateway Traffic and Load Balancer Traffic.\n\nNatgateway Cost - Hourly Charge for NAT Gateway.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "dark-purple",
            "mode": "shades"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "series",
            "axisLabel": "Cost",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 80,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "smooth",
            "lineStyle": {
              "fill": "solid"
            },
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "always",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "currencyUSD"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Networking amortized_cost"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Networking Cost"
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-green",
                  "mode": "shades"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "LoadBalancer amortized_cost"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Load Balancer Cost"
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-orange",
                  "mode": "shades"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "NatGateway amortized_cost"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "NAT GW Cost"
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-blue",
                  "mode": "shades"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Compute amortized_cost"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Compute Cost (amortized)"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 25
      },
      "id": 26,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
          },
          "format": 1,
          "hide": false,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT \ndate_trunc('$CURGranularity', line_item_usage_start_date) as date,\nSUM(CASE\n    WHEN line_item_line_item_type = 'SavingsPlanCoveredUsage' THEN savings_plan_savings_plan_effective_cost\n    WHEN line_item_line_item_type = 'DiscountedUsage' THEN reservation_effective_cost\n    WHEN line_item_line_item_type = 'Usage' THEN line_item_unblended_cost\n    ELSE 0 \n  END) AS amortized_cost\nFROM ${CURDatabase}.${CURTable}\nWHERE \n  $__timeFilter(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2' \n  AND line_item_operation LIKE '%RunInstances%' \n  AND line_item_usage_type NOT LIKE '%DataXfer%' \n  AND product_servicecode <> 'AWSDataTransfer' \n  AND line_item_resource_id NOT LIKE 'arn:%:capacity-reservation/%'\n  AND line_item_line_item_type in ('SavingsPlanCoveredUsage', 'Usage', 'DiscountedUsage')\n  AND line_item_usage_account_id = '${AccountId}'\nAND product_region_code = '${Region}'\nAND resource_tags['${TagKey}'] = '${TagValue}'\nGROUP BY \n  1\n",
          "refId": "Compute"
        },
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
          },
          "format": 1,
          "hide": false,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT \n  date_trunc('$CURGranularity', line_item_usage_start_date),\n  SUM(CASE\n    WHEN line_item_line_item_type = 'SavingsPlanCoveredUsage' THEN savings_plan_savings_plan_effective_cost\n    WHEN line_item_line_item_type = 'DiscountedUsage' THEN reservation_effective_cost\n    WHEN line_item_line_item_type = 'Usage' THEN line_item_unblended_cost\n    ELSE 0 \n  END) AS amortized_cost\nFROM ${CURDatabase}.${CURTable}\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AWSELB'\n  AND (line_item_usage_type LIKE '%LoadBalancerUsage' OR line_item_usage_type LIKE '%LCUUsage' OR line_item_usage_type LIKE '%NLCUUsage')\n  AND line_item_operation LIKE '%LoadBalancing%'\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\nGROUP BY \n  1",
          "refId": "LoadBalancer"
        },
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
          },
          "format": 1,
          "hide": false,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT \ndate_trunc('$CURGranularity', line_item_usage_start_date) as date,\nSUM(CASE\n    WHEN line_item_line_item_type = 'SavingsPlanCoveredUsage' THEN savings_plan_savings_plan_effective_cost\n    WHEN line_item_line_item_type = 'DiscountedUsage' THEN reservation_effective_cost\n    WHEN line_item_line_item_type = 'Usage' THEN line_item_unblended_cost\n    ELSE 0 \n  END) AS amortized_cost\nFROM ${CURDatabase}.${CURTable}\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND (line_item_product_code = 'AWSELB' OR line_item_product_code = 'AmazonEC2')\n  AND (line_item_usage_type LIKE '%-Bytes' OR line_item_usage_type = 'LCUUsage' OR line_item_usage_type = 'NLCUUsage')\n  AND line_item_operation LIKE '%LoadBalancing%'\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\nGROUP BY \n  1",
          "refId": "Networking"
        },
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
          },
          "format": 1,
          "hide": false,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT \n  date_trunc('$CURGranularity', line_item_usage_start_date),\n  SUM(CASE\n    WHEN line_item_line_item_type = 'SavingsPlanCoveredUsage' THEN savings_plan_savings_plan_effective_cost\n    WHEN line_item_line_item_type = 'DiscountedUsage' THEN reservation_effective_cost\n    WHEN line_item_line_item_type = 'Usage' THEN line_item_unblended_cost\n    ELSE 0 \n  END) AS amortized_cost\nFROM ${CURDatabase}.${CURTable}\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AmazonEC2'\n  AND line_item_usage_type LIKE 'NatGateway-Hours'\n  AND line_item_operation = 'NatGateway'\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\nGROUP BY \n  1",
          "refId": "NatGateway"
        }
      ],
      "title": "Service Cost Trends",
      "transparent": true,
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "grafana-athena-datasource",
        "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
      },
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "fillOpacity": 80,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 2,
            "scaleDistribution": {
              "type": "linear"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "currencyUSD"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 7,
        "w": 12,
        "x": 0,
        "y": 33
      },
      "id": 18,
      "options": {
        "barRadius": 0,
        "barWidth": 0.8,
        "fullHighlight": false,
        "groupWidth": 0.7,
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "right",
          "showLegend": true
        },
        "orientation": "horizontal",
        "showValue": "always",
        "stacking": "none",
        "tooltip": {
          "mode": "single",
          "sort": "none"
        },
        "xTickLabelRotation": 0,
        "xTickLabelSpacing": 100
      },
      "pluginVersion": "9.4.7",
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
          },
          "format": 1,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT \n  line_item_availability_zone,\n  SUM(CASE\n    WHEN line_item_line_item_type = 'SavingsPlanCoveredUsage' THEN savings_plan_savings_plan_effective_cost\n    WHEN line_item_line_item_type = 'DiscountedUsage' THEN reservation_effective_cost\n    WHEN line_item_line_item_type = 'Usage' THEN line_item_unblended_cost\n    ELSE 0 \n  END) AS amortized_cost\nFROM ${CURDatabase}.${CURTable}\nWHERE \n$__timeFilter(line_item_usage_start_date)\nAND line_item_product_code = 'AmazonEC2' \nAND line_item_operation LIKE '%RunInstances%' \nAND line_item_usage_type NOT LIKE '%DataXfer%' \nAND product_servicecode <> 'AWSDataTransfer' \nAND line_item_resource_id NOT LIKE 'arn:%:capacity-reservation/%'\nAND line_item_line_item_type in ('SavingsPlanCoveredUsage', 'Usage', 'DiscountedUsage')\nAND line_item_usage_account_id = '${AccountId}'\nAND product_region_code = '${Region}'\nAND resource_tags['${TagKey}'] = '${TagValue}'\nGROUP BY \n1",
          "refId": "CUR AZ Query"
        }
      ],
      "title": "Compute Cost by AZ - Tag: $TagKey Value: $TagValue",
      "transparent": true,
      "type": "barchart"
    },
    {
      "datasource": {
        "type": "grafana-athena-datasource",
        "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "dark-green",
            "mode": "shades"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "fillOpacity": 80,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 2,
            "scaleDistribution": {
              "type": "linear"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "displayName": "amortized cost",
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "currencyUSD"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 7,
        "w": 12,
        "x": 12,
        "y": 33
      },
      "id": 19,
      "options": {
        "barRadius": 0,
        "barWidth": 0.8,
        "fullHighlight": false,
        "groupWidth": 0.7,
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "right",
          "showLegend": true
        },
        "orientation": "horizontal",
        "showValue": "never",
        "stacking": "none",
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        },
        "xTickLabelRotation": 0,
        "xTickLabelSpacing": 100
      },
      "pluginVersion": "9.4.7",
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
          },
          "format": 1,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT \n  product_instance_type as instance_type,\n  SUM(CASE\n    WHEN line_item_line_item_type = 'SavingsPlanCoveredUsage' THEN savings_plan_savings_plan_effective_cost\n    WHEN line_item_line_item_type = 'DiscountedUsage' THEN reservation_effective_cost\n    WHEN line_item_line_item_type = 'Usage' THEN line_item_unblended_cost\n    ELSE 0 \n  END) AS amortized_cost\nFROM ${CURDatabase}.${CURTable}\nWHERE \n  $__timeFilter(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2' \n  AND line_item_operation LIKE '%RunInstances%' \n  AND line_item_usage_type NOT LIKE '%DataXfer%' \n  AND product_servicecode <> 'AWSDataTransfer' \n  AND line_item_resource_id NOT LIKE 'arn:%:capacity-reservation/%'\n  AND line_item_line_item_type in ('SavingsPlanCoveredUsage', 'Usage', 'DiscountedUsage')\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\nGROUP BY \n1",
          "refId": "Instance Family Cost"
        }
      ],
      "title": "Compute Cost by Instance - Tag: $TagKey Value: $TagValue",
      "transparent": true,
      "type": "barchart"
    },
    {
      "collapsed": true,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 40
      },
      "id": 11,
      "panels": [
        {
          "datasource": {
            "type": "datasource",
            "uid": "-- Mixed --"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "fixedColor": "dark-green",
                "mode": "shades"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Cost",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 51,
                "gradientMode": "opacity",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "smooth",
                "lineStyle": {
                  "dash": [
                    0,
                    10
                  ],
                  "fill": "dot"
                },
                "lineWidth": 2,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "auto",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "displayName": "ASG Compute Cost",
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "currencyUSD"
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "GroupTotalInstances"
                },
                "properties": [
                  {
                    "id": "displayName",
                    "value": "Total Instances"
                  },
                  {
                    "id": "unit",
                    "value": "none"
                  },
                  {
                    "id": "color",
                    "value": {
                      "fixedColor": "red",
                      "mode": "shades"
                    }
                  },
                  {
                    "id": "custom.fillOpacity",
                    "value": 10
                  },
                  {
                    "id": "custom.axisLabel",
                    "value": "Count"
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "GroupDesiredCapacity"
                },
                "properties": [
                  {
                    "id": "displayName",
                    "value": "Desired Capacity"
                  },
                  {
                    "id": "color",
                    "value": {
                      "fixedColor": "orange",
                      "mode": "shades"
                    }
                  },
                  {
                    "id": "custom.fillOpacity",
                    "value": 10
                  },
                  {
                    "id": "unit",
                    "value": "none"
                  },
                  {
                    "id": "custom.axisLabel",
                    "value": "Count"
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 19
          },
          "id": 6,
          "links": [
            {
              "targetBlank": true,
              "title": "Cloudwatch",
              "url": "https://$Regions.console.aws.amazon.com/cloudwatch/home?region=$Regions#metricsV2?graph=~(view~'timeSeries~stacked~false~region~'us-east-1~start~'-PT168H~end~'P0D~metrics~(~(~'AWS*2fAutoScaling~'GroupDesiredCapacity~'AutoScalingGroupName~'$ASGName)~(~'.~'GroupTotalCapacity~'.~'.)))&query=~'*7bAWS*2fAutoScaling*2cAutoScalingGroupName*7d*20$ASGName"
            }
          ],
          "options": {
            "legend": {
              "calcs": [
                "max",
                "min"
              ],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "mode": "multi",
              "sort": "none"
            }
          },
          "targets": [
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
              },
              "format": 1,
              "hide": false,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena \nSELECT\n  date_trunc('$CURGranularity', line_item_usage_start_date),\n  SUM(CASE\n    WHEN line_item_line_item_type = 'SavingsPlanCoveredUsage' THEN savings_plan_savings_plan_effective_cost\n    WHEN line_item_line_item_type = 'DiscountedUsage' THEN reservation_effective_cost\n    WHEN line_item_line_item_type = 'Usage' THEN line_item_unblended_cost\n    ELSE 0 \n  END) AS amortized_cost\nFROM ${CURDatabase}.${CURTable}\nWHERE\n  $__timeFilter(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2' \n  AND line_item_operation LIKE '%RunInstances%' \n  AND line_item_usage_type NOT LIKE '%DataXfer%' \n  AND product_servicecode <> 'AWSDataTransfer' \n  AND line_item_resource_id NOT LIKE 'arn:%:capacity-reservation/%'\n  AND line_item_line_item_type in ('SavingsPlanCoveredUsage', 'Usage', 'DiscountedUsage')\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\nGROUP BY 1",
              "refId": "CUR Compute Query"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "${DS_GRAFANA-DASHBOARDS-CLOUDWATCH}"
              },
              "dimensions": {},
              "expression": "SEARCH('{AWS/AutoScaling,AutoScalingGroupName} MetricName=\"GroupDesiredCapacity\" \"$ASGName\"', 'Average', ${CWGranularity})",
              "hide": false,
              "id": "",
              "label": "",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 1,
              "metricName": "",
              "metricQueryType": 0,
              "namespace": "",
              "period": "",
              "queryMode": "Metrics",
              "refId": "GroupDesiredCapacity",
              "region": "$Region",
              "sqlExpression": "",
              "statistic": "Average"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "${DS_GRAFANA-DASHBOARDS-CLOUDWATCH}"
              },
              "dimensions": {},
              "expression": "SEARCH('{\"AWS/AutoScaling\",\"AutoScalingGroupName\"} MetricName=\"GroupTotalInstances\" \"$ASGName\"', 'Average', ${CWGranularity})",
              "id": "",
              "label": "",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 1,
              "metricName": "",
              "metricQueryType": 0,
              "namespace": "",
              "period": "",
              "queryMode": "Metrics",
              "refId": "GroupTotalInstances",
              "region": "$Region",
              "sqlExpression": "",
              "statistic": "Average"
            }
          ],
          "title": "Scaling Activity - ASG: $ASGName",
          "transparent": true,
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "datasource",
            "uid": "-- Mixed --"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "fixedColor": "dark-green",
                "mode": "shades"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Cost",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 50,
                "gradientMode": "opacity",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "smooth",
                "lineStyle": {
                  "dash": [
                    0,
                    10
                  ],
                  "fill": "dot"
                },
                "lineWidth": 2,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "auto",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "displayName": "ASG Compute Cost",
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "currencyUSD"
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "CPUUtilization"
                },
                "properties": [
                  {
                    "id": "displayName",
                    "value": "CPU Utilization"
                  },
                  {
                    "id": "unit",
                    "value": "percent"
                  },
                  {
                    "id": "color",
                    "value": {
                      "fixedColor": "red",
                      "mode": "shades"
                    }
                  },
                  {
                    "id": "custom.axisLabel",
                    "value": "CPU Utilizatoin"
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 19
          },
          "id": 9,
          "links": [
            {
              "targetBlank": true,
              "title": "Cloudwatch",
              "url": "https://$Regions.console.aws.amazon.com/cloudwatch/home?region=$Regions#metricsV2?graph=~(view~'timeSeries~stacked~false~region~'us-east-1~start~'-PT168H~end~'P0D~metrics~(~(~'AWS*2fEC2~'CPUUtilization~'AutoScalingGroupName~'$ASGName)))&query=~'*7bAWS*2fEC2*2cAutoScalingGroupName*7d*20$ASGName"
            }
          ],
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "mode": "multi",
              "sort": "none"
            }
          },
          "targets": [
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
              },
              "format": 1,
              "hide": false,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena \nSELECT\n  date_trunc('$CURGranularity', line_item_usage_start_date),\n  SUM(CASE\n    WHEN line_item_line_item_type = 'SavingsPlanCoveredUsage' THEN savings_plan_savings_plan_effective_cost\n    WHEN line_item_line_item_type = 'DiscountedUsage' THEN reservation_effective_cost\n    WHEN line_item_line_item_type = 'Usage' THEN line_item_unblended_cost\n    ELSE 0 \n  END) AS amortized_cost\nFROM ${CURDatabase}.${CURTable}\nWHERE\n  $__timeFilter(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2' \n  AND line_item_operation LIKE '%RunInstances%' \n  AND line_item_usage_type NOT LIKE '%DataXfer%' \n  AND product_servicecode <> 'AWSDataTransfer' \n  AND line_item_resource_id NOT LIKE 'arn:%:capacity-reservation/%'\n  AND line_item_line_item_type in ('SavingsPlanCoveredUsage', 'Usage', 'DiscountedUsage')\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\nGROUP BY 1\nORDER BY 1",
              "refId": "CUR Compute Query"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "${DS_GRAFANA-DASHBOARDS-CLOUDWATCH}"
              },
              "dimensions": {},
              "expression": "REMOVE_EMPTY(SEARCH('{\"AWS/EC2\",\"AutoScalingGroupName\"} MetricName=\"CPUUtilization\" \"$ASGName\"', 'Average', ${CWGranularity}))",
              "id": "",
              "label": "",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 1,
              "metricName": "",
              "metricQueryType": 0,
              "namespace": "",
              "period": "",
              "queryMode": "Metrics",
              "refId": "CPUUtilization",
              "region": "$Region",
              "sqlExpression": "",
              "statistic": "Average"
            }
          ],
          "title": "Average CPU - ASG: $ASGName",
          "transparent": true,
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "datasource",
            "uid": "-- Mixed --"
          },
          "description": "Status failure Metrics for the entire ASG. This metric reports whether the instance has passed both the instance status check and the system status check in the last minute. This metric can be either 0 (passed) or 1 (failed). By default, this metric is available at a 1-minute frequency at no charge.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "fixedColor": "dark-green",
                "mode": "shades"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Cost",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 50,
                "gradientMode": "opacity",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "smooth",
                "lineStyle": {
                  "dash": [
                    0,
                    10
                  ],
                  "fill": "dot"
                },
                "lineWidth": 2,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "auto",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "displayName": "ASG Compute Cost",
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "currencyUSD"
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "StatusCheckFailed"
                },
                "properties": [
                  {
                    "id": "displayName",
                    "value": "Status Failed Check"
                  },
                  {
                    "id": "unit",
                    "value": "none"
                  },
                  {
                    "id": "color",
                    "value": {
                      "fixedColor": "red",
                      "mode": "shades"
                    }
                  },
                  {
                    "id": "custom.axisLabel",
                    "value": "Failed Checks"
                  },
                  {
                    "id": "custom.fillOpacity",
                    "value": 10
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 27
          },
          "id": 20,
          "links": [
            {
              "targetBlank": true,
              "title": "Cloudwatch",
              "url": "https://$Regions.console.aws.amazon.com/cloudwatch/home?region=$Regions#metricsV2?graph=~(view~'timeSeries~stacked~false~region~'us-east-1~start~'-PT168H~end~'P0D~metrics~(~(~'AWS*2fEC2~'StatusCheckFailed~'AutoScalingGroupName~'$ASGName)))&query=~'*7bAWS*2fEC2*2cAutoScalingGroupName*7d*20$ASGName"
            }
          ],
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "mode": "multi",
              "sort": "none"
            }
          },
          "targets": [
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
              },
              "format": 1,
              "hide": true,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT\n  date_trunc('$CURGranularity', line_item_usage_start_date),\n  SUM(CASE\n    WHEN line_item_line_item_type = 'SavingsPlanCoveredUsage' THEN savings_plan_savings_plan_effective_cost\n    WHEN line_item_line_item_type = 'DiscountedUsage' THEN reservation_effective_cost\n    WHEN line_item_line_item_type = 'Usage' THEN line_item_unblended_cost\n    ELSE 0 \n  END) AS amortized_cost\nFROM ${CURDatabase}.${CURTable}\nWHERE\n  $__timeFilter(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2'\n  AND line_item_operation = 'RunInstances'\n  AND line_item_usage_type Like '%Box%'\n  AND line_item_line_item_type in  ('Usage', 'SavingsPlanCoveredUsage', 'DiscountedUsage')\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\nGROUP BY 1\nORDER BY 1",
              "refId": "CUR Compute Query"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "${DS_GRAFANA-DASHBOARDS-CLOUDWATCH}"
              },
              "dimensions": {},
              "expression": "SEARCH('{\"AWS/EC2\",\"AutoScalingGroupName\"} MetricName=\"StatusCheckFailed\" \"$ASGName\"', 'Average', ${CWGranularity})",
              "id": "",
              "label": "",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 1,
              "metricName": "",
              "metricQueryType": 0,
              "namespace": "",
              "period": "",
              "queryMode": "Metrics",
              "refId": "StatusCheckFailed",
              "region": "$Region",
              "sqlExpression": "",
              "statistic": "Average"
            }
          ],
          "title": "Instance Status Check Failed - ASG: $ASGName",
          "transparent": true,
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "datasource",
            "uid": "-- Mixed --"
          },
          "description": "CPU Credit usage and balance metrics for the entire ASG. These metrics reports the number of earned and used CPU credits that an instance has accrued since it was launched or started.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "fixedColor": "dark-green",
                "mode": "shades"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Cost",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 50,
                "gradientMode": "opacity",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "smooth",
                "lineStyle": {
                  "dash": [
                    0,
                    10
                  ],
                  "fill": "dot"
                },
                "lineWidth": 2,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "auto",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "displayName": "ASG Compute Cost",
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green",
                    "value": null
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "currencyUSD"
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "CPUCreditBalance"
                },
                "properties": [
                  {
                    "id": "displayName",
                    "value": "CPU Credit Balance"
                  },
                  {
                    "id": "custom.gradientMode",
                    "value": "opacity"
                  },
                  {
                    "id": "color",
                    "value": {
                      "fixedColor": "red",
                      "mode": "shades"
                    }
                  },
                  {
                    "id": "custom.axisPlacement",
                    "value": "right"
                  },
                  {
                    "id": "custom.axisLabel",
                    "value": "CPU Credit Balance"
                  },
                  {
                    "id": "unit",
                    "value": "none"
                  },
                  {
                    "id": "custom.fillOpacity",
                    "value": 15
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "CPUCreditUsage"
                },
                "properties": [
                  {
                    "id": "color",
                    "value": {
                      "fixedColor": "orange",
                      "mode": "shades"
                    }
                  },
                  {
                    "id": "displayName",
                    "value": "CPU Credit Usage"
                  },
                  {
                    "id": "custom.axisPlacement",
                    "value": "right"
                  },
                  {
                    "id": "custom.axisLabel",
                    "value": "CPU Credit Usage"
                  },
                  {
                    "id": "unit",
                    "value": "none"
                  },
                  {
                    "id": "custom.fillOpacity",
                    "value": 15
                  },
                  {
                    "id": "custom.gradientMode",
                    "value": "opacity"
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 27
          },
          "id": 98,
          "links": [
            {
              "targetBlank": true,
              "title": "Cloudwatch",
              "url": "https://$Regions.console.aws.amazon.com/cloudwatch/home?region=$Regions#metricsV2?graph=~(view~'timeSeries~stacked~false~region~'us-east-1~start~'-PT168H~end~'P0D~metrics~(~(~'AWS*2fEC2~'StatusCheckFailed~'AutoScalingGroupName~'$ASGName)))&query=~'*7bAWS*2fEC2*2cAutoScalingGroupName*7d*20$ASGName"
            }
          ],
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "mode": "multi",
              "sort": "none"
            }
          },
          "targets": [
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
              },
              "format": 1,
              "hide": true,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT\n  date_trunc('$CURGranularity', line_item_usage_start_date),\n  SUM(CASE\n    WHEN line_item_line_item_type = 'SavingsPlanCoveredUsage' THEN savings_plan_savings_plan_effective_cost\n    WHEN line_item_line_item_type = 'DiscountedUsage' THEN reservation_effective_cost\n    WHEN line_item_line_item_type = 'Usage' THEN line_item_unblended_cost\n    ELSE 0 \n  END) AS amortized_cost\nFROM ${CURDatabase}.${CURTable}\nWHERE\n  $__timeFilter(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2'\n  AND line_item_operation = 'RunInstances'\n  AND line_item_line_item_type in  ('Usage', 'SavingsPlanCoveredUsage', 'DiscountedUsage')\n  AND line_item_usage_type Like '%Box%'\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\nGROUP BY 1\nORDER BY 1",
              "refId": "CUR Compute Query"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "${DS_GRAFANA-DASHBOARDS-CLOUDWATCH}"
              },
              "dimensions": {},
              "expression": "SEARCH('{\"AWS/EC2\",\"AutoScalingGroupName\"} MetricName=\"CPUCreditBalance\" \"$ASGName\"', 'Average', ${CWGranularity})",
              "id": "",
              "label": "",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 1,
              "metricName": "",
              "metricQueryType": 0,
              "namespace": "",
              "period": "",
              "queryMode": "Metrics",
              "refId": "CPUCreditBalance",
              "region": "$Region",
              "sqlExpression": "",
              "statistic": "Average"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "${DS_GRAFANA-DASHBOARDS-CLOUDWATCH}"
              },
              "dimensions": {},
              "expression": "SEARCH('{\"AWS/EC2\",\"AutoScalingGroupName\"} MetricName=\"CPUCreditUsage\" \"$ASGName\"', 'Average', ${CWGranularity})",
              "hide": false,
              "id": "",
              "label": "",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 1,
              "metricName": "",
              "metricQueryType": 0,
              "namespace": "",
              "period": "",
              "queryMode": "Metrics",
              "refId": "CPUCreditUsage",
              "region": "$Region",
              "sqlExpression": "",
              "statistic": "Average"
            }
          ],
          "title": "CPU Credit Usage - ASG: $ASGName",
          "transparent": true,
          "type": "timeseries"
        }
      ],
      "title": "Compute - Autoscaling Group: $ASGName",
      "type": "row"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 41
      },
      "id": 24,
      "panels": [],
      "title": "Network - Autoscaling Group: $ASGName",
      "type": "row"
    },
    {
      "datasource": {
        "type": "datasource",
        "uid": "-- Mixed --"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "dark-green",
            "mode": "shades"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Cost",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 49,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "smooth",
            "lineStyle": {
              "dash": [
                0,
                10
              ],
              "fill": "dot"
            },
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "displayName": "ASG Networking Cost",
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "currencyUSD"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byFrameRefID",
              "options": "NetworkOut"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Network Out"
              },
              {
                "id": "color",
                "value": {
                  "mode": "continuous-BlYlRd"
                }
              },
              {
                "id": "unit",
                "value": "bytes"
              },
              {
                "id": "custom.axisLabel",
                "value": "Bytes"
              },
              {
                "id": "custom.fillOpacity",
                "value": 10
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 42
      },
      "id": 22,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
          },
          "format": 1,
          "hide": false,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT \n  date_trunc('$CURGranularity', line_item_usage_start_date),\n  SUM(line_item_unblended_cost) as unblended_cost\nFROM ${CURDatabase}.${CURTable}\nWHERE \n  $__timeFilter(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2'\n  AND line_item_usage_type LIKE '%AWS%Bytes%'\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\nGROUP BY \n1\nHAVING SUM(line_item_unblended_cost) > 0\n\n",
          "refId": "EC2 Network Cost Query"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_GRAFANA-DASHBOARDS-CLOUDWATCH}"
          },
          "dimensions": {},
          "expression": "SEARCH('{\"AWS/EC2\",\"AutoScalingGroupName\"} MetricName=\"NetworkOut\" \"$ASGName\"', 'Average', ${CWGranularity})",
          "id": "",
          "label": "",
          "logGroups": [],
          "matchExact": true,
          "metricEditorMode": 1,
          "metricName": "",
          "metricQueryType": 0,
          "namespace": "",
          "period": "",
          "queryMode": "Metrics",
          "refId": "NetworkOut",
          "region": "$Region",
          "sqlExpression": "",
          "statistic": "Average"
        }
      ],
      "title": "EC2 Networking Bytes Out- ASG: $ASGName",
      "transparent": true,
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "datasource",
        "uid": "-- Mixed --"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "dark-green",
            "mode": "shades"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Cost",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 50,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "smooth",
            "lineStyle": {
              "dash": [
                0,
                10
              ],
              "fill": "dot"
            },
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "displayName": "ASG Networking Cost",
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "currencyUSD"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byFrameRefID",
              "options": "NetworkPacketsOut"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Network Packets Out"
              },
              {
                "id": "color",
                "value": {
                  "mode": "continuous-BlYlRd"
                }
              },
              {
                "id": "unit",
                "value": "none"
              },
              {
                "id": "custom.axisLabel",
                "value": "Packets Out"
              },
              {
                "id": "custom.fillOpacity",
                "value": 10
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 42
      },
      "id": 41,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
          },
          "format": 1,
          "hide": false,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT \n  date_trunc('$CURGranularity', line_item_usage_start_date),\n  SUM(line_item_unblended_cost) as unblended_cost\nFROM ${CURDatabase}.${CURTable}\nWHERE \n  $__timeFilter(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2'\n  AND line_item_usage_type LIKE '%AWS%Bytes%'\n  AND line_item_usage_account_id = '${AccountId}'\nAND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\nGROUP BY \n1\nHAVING SUM(line_item_unblended_cost) > 0\n\n",
          "refId": "EC2 Network Cost Query"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_GRAFANA-DASHBOARDS-CLOUDWATCH}"
          },
          "dimensions": {},
          "expression": "SEARCH('{\"AWS/EC2\",\"AutoScalingGroupName\"} MetricName=\"NetworkPacketsOut\" \"$ASGName\"', 'Average', ${CWGranularity})",
          "id": "",
          "label": "",
          "logGroups": [],
          "matchExact": true,
          "metricEditorMode": 1,
          "metricName": "",
          "metricQueryType": 0,
          "namespace": "",
          "period": "",
          "queryMode": "Metrics",
          "refId": "NetworkPacketsOut",
          "region": "$Region",
          "sqlExpression": "",
          "statistic": "Average"
        }
      ],
      "title": "EC2 Networking Packets Out - ASG: $ASGName",
      "transparent": true,
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 50
      },
      "id": 48,
      "panels": [],
      "title": "EBS Activity - $ASGName",
      "type": "row"
    },
    {
      "datasource": {
        "type": "datasource",
        "uid": "-- Mixed --"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "green",
            "mode": "shades"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "EBS Volume Cost",
            "axisPlacement": "left",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 50,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "smooth",
            "lineStyle": {
              "dash": [
                0,
                10
              ],
              "fill": "dot"
            },
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "displayName": "EBS Volume Cost",
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "currencyUSD"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byFrameRefID",
              "options": "EBSReadBytes"
            },
            "properties": [
              {
                "id": "custom.fillOpacity",
                "value": 15
              },
              {
                "id": "custom.axisPlacement",
                "value": "right"
              },
              {
                "id": "custom.axisLabel",
                "value": "EBS Read Bytes"
              },
              {
                "id": "unit",
                "value": "bytes"
              },
              {
                "id": "displayName",
                "value": "EBS Read Bytes"
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "shades"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byFrameRefID",
              "options": "EBSWriteBytes"
            },
            "properties": [
              {
                "id": "custom.fillOpacity",
                "value": 15
              },
              {
                "id": "custom.axisPlacement",
                "value": "right"
              },
              {
                "id": "custom.axisLabel",
                "value": "EBS Write Bytes"
              },
              {
                "id": "unit",
                "value": "bytes"
              },
              {
                "id": "displayName",
                "value": "EBS Write Bytes"
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "shades"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 51
      },
      "id": 49,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
          },
          "format": 1,
          "hide": false,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT \n  date_trunc('$CURGranularity', line_item_usage_start_date),\n  SUM(line_item_unblended_cost) as unblended_cost\nFROM ${CURDatabase}.${CURTable}\nWHERE \n  $__timeFilter(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2'\n  AND line_item_usage_type Like '%VolumeUsage%'\n  AND line_item_usage_account_id = '${AccountId}'\nAND product_region_code = '${Region}'\nAND resource_tags['${TagKey}'] = '${TagValue}'\nGROUP BY \n1\nHAVING SUM(line_item_unblended_cost) > 0",
          "refId": "EBS Volume Cost"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_GRAFANA-DASHBOARDS-CLOUDWATCH}"
          },
          "dimensions": {},
          "expression": "SEARCH('{\"AWS/EC2\",\"AutoScalingGroupName\"} MetricName=\"EBSReadBytes\" \"$ASGName\"', 'Average', ${CWGranularity})",
          "id": "",
          "label": "",
          "logGroups": [],
          "matchExact": true,
          "metricEditorMode": 1,
          "metricName": "",
          "metricQueryType": 0,
          "namespace": "",
          "period": "",
          "queryMode": "Metrics",
          "refId": "EBSReadBytes",
          "region": "$Region",
          "sqlExpression": "",
          "statistic": "Average"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_GRAFANA-DASHBOARDS-CLOUDWATCH}"
          },
          "dimensions": {},
          "expression": "SEARCH('{\"AWS/EC2\",\"AutoScalingGroupName\"} MetricName=\"EBSWriteBytes\" \"$ASGName\"', 'Average', ${CWGranularity})",
          "hide": false,
          "id": "",
          "label": "",
          "logGroups": [],
          "matchExact": true,
          "metricEditorMode": 1,
          "metricName": "",
          "metricQueryType": 0,
          "namespace": "",
          "period": "",
          "queryMode": "Metrics",
          "refId": "EBSWriteBytes",
          "region": "$Region",
          "sqlExpression": "",
          "statistic": "Average"
        }
      ],
      "title": "EBS Volume Read/Write- ASG: $ASGName",
      "transparent": true,
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "datasource",
        "uid": "-- Mixed --"
      },
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "green",
            "mode": "shades"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "EBS Volume Cost",
            "axisPlacement": "left",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 50,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "smooth",
            "lineStyle": {
              "dash": [
                0,
                10
              ],
              "fill": "dot"
            },
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "displayName": "EBS Volume Cost",
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "currencyUSD"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byFrameRefID",
              "options": "EBSReadOps"
            },
            "properties": [
              {
                "id": "custom.fillOpacity",
                "value": 15
              },
              {
                "id": "custom.axisPlacement",
                "value": "right"
              },
              {
                "id": "custom.axisLabel",
                "value": "EBS Read Bytes"
              },
              {
                "id": "unit",
                "value": "bytes"
              },
              {
                "id": "displayName",
                "value": "EBS Read Bytes"
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "shades"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byFrameRefID",
              "options": "EBSWriteOps"
            },
            "properties": [
              {
                "id": "custom.fillOpacity",
                "value": 15
              },
              {
                "id": "custom.axisPlacement",
                "value": "right"
              },
              {
                "id": "custom.axisLabel",
                "value": "EBS Write Bytes"
              },
              {
                "id": "unit",
                "value": "bytes"
              },
              {
                "id": "displayName",
                "value": "EBS Write Bytes"
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "shades"
                }
              }
            ]
          },
          {
            "__systemRef": "hideSeriesFrom",
            "matcher": {
              "id": "byNames",
              "options": {
                "mode": "exclude",
                "names": [
                  "EBS Read Bytes"
                ],
                "prefix": "All except:",
                "readOnly": true
              }
            },
            "properties": [
              {
                "id": "custom.hideFrom",
                "value": {
                  "legend": false,
                  "tooltip": false,
                  "viz": true
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 51
      },
      "id": 99,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
          },
          "format": 1,
          "hide": false,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT \n  date_trunc('$CURGranularity', line_item_usage_start_date),\n  SUM(line_item_unblended_cost) as unblended_cost\nFROM ${CURDatabase}.${CURTable}\nWHERE \n  $__timeFilter(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2'\n  AND line_item_usage_type Like '%VolumeUsage%'\n  AND line_item_usage_account_id = '${AccountId}'\nAND product_region_code = '${Region}'\nAND resource_tags['${TagKey}'] = '${TagValue}'\nGROUP BY \n1\nHAVING SUM(line_item_unblended_cost) > 0",
          "refId": "EBS Volume Cost"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_GRAFANA-DASHBOARDS-CLOUDWATCH}"
          },
          "dimensions": {},
          "expression": "SEARCH('{\"AWS/EC2\",\"AutoScalingGroupName\"} MetricName=\"EBSReadOps\" \"$ASGName\"', 'Average', ${CWGranularity})",
          "id": "",
          "label": "",
          "logGroups": [],
          "matchExact": true,
          "metricEditorMode": 1,
          "metricName": "",
          "metricQueryType": 0,
          "namespace": "",
          "period": "",
          "queryMode": "Metrics",
          "refId": "EBSReadOps",
          "region": "$Region",
          "sqlExpression": "",
          "statistic": "Average"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_GRAFANA-DASHBOARDS-CLOUDWATCH}"
          },
          "dimensions": {},
          "expression": "SEARCH('{\"AWS/EC2\",\"AutoScalingGroupName\"} MetricName=\"EBSWriteOps\" \"$ASGName\"', 'Average', ${CWGranularity})",
          "hide": false,
          "id": "",
          "label": "",
          "logGroups": [],
          "matchExact": true,
          "metricEditorMode": 1,
          "metricName": "",
          "metricQueryType": 0,
          "namespace": "",
          "period": "",
          "queryMode": "Metrics",
          "refId": "EBSWriteOps",
          "region": "$Region",
          "sqlExpression": "",
          "statistic": "Average"
        }
      ],
      "title": "EBS Volume ReadOps/WriteOps- ASG: $ASGName",
      "transparent": true,
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 59
      },
      "id": 38,
      "panels": [],
      "repeat": "LBName",
      "repeatDirection": "h",
      "title": "ELB Networking",
      "type": "row"
    },
    {
      "gridPos": {
        "h": 2,
        "w": 24,
        "x": 0,
        "y": 60
      },
      "id": 97,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "Data for seleted load balancer: ${LBName}",
        "mode": "markdown"
      },
      "pluginVersion": "10.4.1",
      "type": "text"
    },
    {
      "datasource": {
        "type": "datasource",
        "uid": "-- Mixed --"
      },
      "description": "Load Balancer LCU Usage for $LBName - Be sure to update the Load Balancer Name variable at the top of the dashboard.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "dark-green",
            "mode": "shades"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Cost",
            "axisPlacement": "left",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 50,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "smooth",
            "lineStyle": {
              "dash": [
                0,
                10
              ],
              "fill": "dot"
            },
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "displayName": "LB Cost",
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "currencyUSD"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byFrameRefID",
              "options": "ConsumedLCUs"
            },
            "properties": [
              {
                "id": "custom.fillOpacity",
                "value": 15
              },
              {
                "id": "custom.axisPlacement",
                "value": "right"
              },
              {
                "id": "custom.axisLabel",
                "value": "Consumed LCU"
              },
              {
                "id": "unit",
                "value": "none"
              },
              {
                "id": "displayName",
                "value": "Consumed LCU"
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "shades"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 62
      },
      "id": 40,
      "links": [
        {
          "targetBlank": true,
          "title": "ELB Pricing Page",
          "url": "https://aws.amazon.com/elasticloadbalancing/pricing/"
        }
      ],
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
          },
          "format": 1,
          "hide": false,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT\ndate_trunc('$CURGranularity', line_item_usage_start_date),\nSUM(line_item_unblended_cost) as cost\nFROM ${CURDatabase}.${CURTable}\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AWSELB'\n  AND (line_item_usage_type LIKE '%LoadBalancerUsage' OR line_item_usage_type LIKE '%LCUUsage' OR line_item_usage_type LIKE '%NLCUUsage')\n  AND line_item_operation LIKE '%LoadBalancing%'\n  AND line_item_resource_id LIKE '%$LBName'\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\n  GROUP BY\n  1\n  HAVING SUM(line_item_unblended_cost) > 0 \n",
          "refId": "LCUUsage"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_GRAFANA-DASHBOARDS-CLOUDWATCH}"
          },
          "dimensions": {},
          "expression": "SEARCH('{\"AWS/ApplicationELB\",\"LoadBalancer\"} MetricName=\"ConsumedLCUs\" \"$LBName\"', 'Sum', ${CWGranularity})",
          "id": "",
          "label": "",
          "logGroups": [],
          "matchExact": true,
          "metricEditorMode": 1,
          "metricName": "",
          "metricQueryType": 0,
          "namespace": "",
          "period": "",
          "queryMode": "Metrics",
          "refId": "ConsumedLCUs",
          "region": "$Region",
          "sqlExpression": "",
          "statistic": "Average"
        }
      ],
      "title": "LCU Metrics ",
      "transparent": true,
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "datasource",
        "uid": "-- Mixed --"
      },
      "description": "Load Balancer LCU Usage for ELB $LBName - Be sure to update the Load Balancer Name variable at the top of the dashboard.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "green",
            "mode": "shades"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Loadbalancer Hourly Cost",
            "axisPlacement": "left",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 50,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "smooth",
            "lineStyle": {
              "dash": [
                0,
                10
              ],
              "fill": "dot"
            },
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "displayName": "ELB Hourly Cost",
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "currencyUSD"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byFrameRefID",
              "options": "ConsumedLCUs"
            },
            "properties": [
              {
                "id": "custom.fillOpacity",
                "value": 15
              },
              {
                "id": "custom.axisPlacement",
                "value": "right"
              },
              {
                "id": "custom.axisLabel",
                "value": "ConsumedLCU"
              },
              {
                "id": "unit",
                "value": "none"
              },
              {
                "id": "displayName",
                "value": "Consumed LCU"
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "shades"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 62
      },
      "id": 39,
      "links": [
        {
          "targetBlank": true,
          "title": "ELB Pricing Page",
          "url": "https://aws.amazon.com/elasticloadbalancing/pricing/"
        }
      ],
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
          },
          "format": 1,
          "hide": false,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT\ndate_trunc('$CURGranularity', line_item_usage_start_date),\nSUM(line_item_unblended_cost) as cost\nFROM ${CURDatabase}.${CURTable}\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AWSELB'\n  AND (line_item_usage_type LIKE '%LoadBalancerUsage' OR line_item_usage_type LIKE '%LCUUsage' OR line_item_usage_type LIKE '%NLCUUsage')\n  AND line_item_operation LIKE '%LoadBalancing%'\n  AND line_item_resource_id LIKE '%$LBName'\n  AND line_item_usage_account_id = '${AccountId}'\nAND product_region_code = '${Region}'\nAND resource_tags['${TagKey}'] = '${TagValue}'\n  GROUP BY\n  1\n  HAVING SUM(line_item_unblended_cost) > 0 \n",
          "refId": "LCUUsage"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_GRAFANA-DASHBOARDS-CLOUDWATCH}"
          },
          "dimensions": {},
          "expression": "SEARCH('{\"AWS/ApplicationELB\",\"LoadBalancer\"} MetricName=\"ConsumedLCUs\" \"$LBName\"', 'Sum', ${CWGranularity})",
          "id": "",
          "label": "",
          "logGroups": [],
          "matchExact": true,
          "metricEditorMode": 1,
          "metricName": "",
          "metricQueryType": 0,
          "namespace": "",
          "period": "",
          "queryMode": "Metrics",
          "refId": "ConsumedLCUs",
          "region": "$Region",
          "sqlExpression": "",
          "statistic": "Average"
        }
      ],
      "title": "Hourly Cost and Requests  ",
      "transparent": true,
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 70
      },
      "id": 53,
      "panels": [],
      "repeat": "NGWName",
      "repeatDirection": "h",
      "title": "NatGateway - TagValue: $TagValue - NGWName - $NGWName",
      "type": "row"
    },
    {
      "datasource": {
        "type": "datasource",
        "uid": "-- Mixed --"
      },
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-BlPu"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Bytes Out",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 30,
            "gradientMode": "scheme",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "smooth",
            "lineStyle": {
              "dash": [
                0,
                10
              ],
              "fill": "dot"
            },
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "none"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byFrameRefID",
              "options": "NGWTraffic"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "mode": "continuous-GrYlRd"
                }
              },
              {
                "id": "custom.fillOpacity",
                "value": 0
              },
              {
                "id": "displayName",
                "value": "Nat Gateway Traffic Cost"
              },
              {
                "id": "custom.showPoints",
                "value": "always"
              },
              {
                "id": "custom.axisLabel",
                "value": "Traffic Cost"
              },
              {
                "id": "unit",
                "value": "currencyUSD"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 71
      },
      "id": 51,
      "links": [
        {
          "targetBlank": true,
          "title": "ELB Pricing Page",
          "url": "https://aws.amazon.com/elasticloadbalancing/pricing/"
        }
      ],
      "options": {
        "legend": {
          "calcs": [
            "max",
            "min"
          ],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
          },
          "format": 1,
          "hide": false,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT\ndate_trunc('$CURGranularity', line_item_usage_start_date),\nSUM(line_item_unblended_cost) as cost\nFROM ${CURDatabase}.${CURTable}\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AmazonEC2'\n  AND line_item_usage_type = 'NatGateway-Bytes'\n  AND line_item_operation = 'NatGateway'\n  AND line_item_resource_id LIKE CONCAT('%', '$NGWName')\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\n  GROUP BY\n  1\n",
          "refId": "NGWTraffic"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_GRAFANA-DASHBOARDS-CLOUDWATCH}"
          },
          "dimensions": {},
          "expression": "SEARCH('{\"AWS/NATGateway\",\"NatGatewayId\"} MetricName=\"BytesOutToDestination\" \"$NGWName\"', 'Average', ${CWGranularity})",
          "id": "",
          "label": "",
          "logGroups": [],
          "matchExact": true,
          "metricEditorMode": 1,
          "metricName": "",
          "metricQueryType": 0,
          "namespace": "",
          "period": "",
          "queryMode": "Metrics",
          "refId": "BytesOutToDestination",
          "region": "$Region",
          "sqlExpression": "",
          "statistic": "Average"
        }
      ],
      "title": "NatGateway Traffic Cost",
      "transparent": true,
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "datasource",
        "uid": "-- Mixed --"
      },
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-BlPu"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Bytes Out",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 30,
            "gradientMode": "scheme",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "smooth",
            "lineStyle": {
              "dash": [
                0,
                10
              ],
              "fill": "dot"
            },
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "none"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byFrameRefID",
              "options": "NGWHourly"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "yellow",
                  "mode": "fixed"
                }
              },
              {
                "id": "custom.fillOpacity",
                "value": 0
              },
              {
                "id": "unit",
                "value": "currencyUSD"
              },
              {
                "id": "displayName",
                "value": "NatGateway Hourly Cost"
              },
              {
                "id": "custom.showPoints",
                "value": "always"
              },
              {
                "id": "unit",
                "value": "currencyUSD"
              },
              {
                "id": "custom.axisLabel",
                "value": "NatGateway Hourly Cost"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 71
      },
      "id": 54,
      "links": [
        {
          "targetBlank": true,
          "title": "ELB Pricing Page",
          "url": "https://aws.amazon.com/elasticloadbalancing/pricing/"
        }
      ],
      "options": {
        "legend": {
          "calcs": [
            "max",
            "min"
          ],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
          },
          "format": 1,
          "hide": false,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT\ndate_trunc('$CURGranularity', line_item_usage_start_date),\nSUM(line_item_unblended_cost) as cost\nFROM ${CURDatabase}.${CURTable}\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AmazonEC2'\n  AND line_item_usage_type = 'NatGateway-Hours'\n  AND line_item_operation = 'NatGateway'\n  AND line_item_resource_id LIKE CONCAT('%', '$NGWName')\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\n  GROUP BY\n  1\n",
          "refId": "NGWHourly"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_GRAFANA-DASHBOARDS-CLOUDWATCH}"
          },
          "dimensions": {},
          "expression": "SEARCH('{\"AWS/NATGateway\",\"NatGatewayId\"} MetricName=\"BytesOutToDestination\" \"$NGWName\"', 'Average', ${CWGranularity})",
          "id": "",
          "label": "",
          "logGroups": [],
          "matchExact": true,
          "metricEditorMode": 1,
          "metricName": "",
          "metricQueryType": 0,
          "namespace": "",
          "period": "",
          "queryMode": "Metrics",
          "refId": "BytesOutToDestination",
          "region": "$Region",
          "sqlExpression": "",
          "statistic": "Average"
        }
      ],
      "title": "NatGateway Test",
      "transparent": true,
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 79
      },
      "id": 92,
      "panels": [],
      "title": "Resource Index",
      "type": "row"
    },
    {
      "datasource": {
        "type": "grafana-athena-datasource",
        "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
      },
      "description": "Compute resources with tag_key: $TagKey and tag_value: $TagValue observed in the past 30 days.  The last_observed column will list the timestamp when the resource was last seen in the CUR file.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 80
      },
      "id": 94,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "product_vcpu"
          }
        ]
      },
      "pluginVersion": "10.4.1",
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
          },
          "format": 1,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena \nSELECT\n  line_item_resource_id as instance_id,\n  product_instance_type as instance_type,\n  product['vcpu'] as vcpu,\n  MAX(line_item_usage_start_date) AS last_observed\nFROM ${CURDatabase}.${CURTable}\nWHERE\n  -- $__timeFilter(line_item_usage_start_date)\n  line_item_product_code = 'AmazonEC2' \n  AND line_item_operation LIKE '%RunInstances%' \n  AND line_item_usage_type NOT LIKE '%DataXfer%' \n  AND product_servicecode <> 'AWSDataTransfer' \n  AND line_item_resource_id NOT LIKE 'arn:%:capacity-reservation/%'\n  AND line_item_line_item_type in ('SavingsPlanCoveredUsage', 'Usage', 'DiscountedUsage')\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}'\n  AND line_item_usage_start_date <= CURRENT_DATE\n  AND line_item_usage_start_date >= DATE_ADD('day', -30, CURRENT_DATE)\nGROUP BY 1,2,3\nORDER BY 4 DESC",
          "refId": "A"
        }
      ],
      "title": "Compute Resources (EC2)",
      "type": "table"
    }
  ],
  "refresh": "",
  "revision": 1,
  "schemaVersion": 39,
  "tags": [],
  "templating": {
    "list": [
      {
        "current": {
          "selected": false,
          "text": "grafana-dashboards-athena",
          "value": "ber8a0v9qmhhcc"
        },
        "description": "Athena CUR Table connection for queries to AWS Cost and Usage",
        "hide": 2,
        "includeAll": false,
        "label": "CUR Datasource",
        "multi": false,
        "name": "CURDatasource",
        "options": [],
        "query": "grafana-athena-datasource",
        "queryValue": "",
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "type": "datasource"
      },
      {
        "current": {
          "selected": false,
          "text": "grafana-dashboards-cloudwatch",
          "value": "cer8a0l7ryq68e"
        },
        "description": "CloudWatch Datasource, for queries to metrics and logs",
        "hide": 2,
        "includeAll": false,
        "label": "CloudWatch Datasource",
        "multi": false,
        "name": "CWDatasource",
        "options": [],
        "query": "cloudwatch",
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "type": "datasource"
      },
      {
        "current": {
          "selected": false,
          "text": "cid_data_export",
          "value": "cid_data_export"
        },
        "description": "CUR Database; change this name if you have modified the installation procedures ",
        "hide": 2,
        "includeAll": false,
        "label": "CUR Database",
        "multi": false,
        "name": "CURDatabase",
        "options": [
          {
            "selected": true,
            "text": "cid_data_export",
            "value": "cid_data_export"
          }
        ],
        "query": "cid_data_export",
        "skipUrlSync": false,
        "type": "custom"
      },
      {
        "current": {
          "selected": false,
          "text": "cur2",
          "value": "cur2"
        },
        "description": "CUR Table name; change if your table for CUR 2 data is not named cur2",
        "hide": 2,
        "includeAll": false,
        "label": "CUR Table",
        "multi": false,
        "name": "CURTable",
        "options": [
          {
            "selected": true,
            "text": "cur2",
            "value": "cur2"
          }
        ],
        "query": "cur2",
        "skipUrlSync": false,
        "type": "custom"
      },
      {
        "current": {},
        "datasource": {
          "type": "grafana-athena-datasource",
          "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
        },
        "definition": "",
        "description": "All account IDs found in the CUR for the time period selected.",
        "hide": 0,
        "includeAll": false,
        "label": "Account ID",
        "multi": false,
        "name": "AccountId",
        "options": [],
        "query": {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "format": 1,
          "rawSQL": "SELECT \nDISTINCT line_item_usage_account_id\nFROM ${CURDatabase}.${CURTable}\nWHERE \n$__timeFilter(line_item_usage_start_date);\n"
        },
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query"
      },
      {
        "current": {},
        "datasource": {
          "type": "grafana-athena-datasource",
          "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
        },
        "definition": "",
        "description": "Regions observed in the CUR over the look back period",
        "hide": 0,
        "includeAll": false,
        "label": "Region",
        "multi": false,
        "name": "Region",
        "options": [],
        "query": {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "format": 1,
          "rawSQL": "SELECT \nDISTINCT product_region_code,\nCASE \n    WHEN product_region_code = 'us-east-1' THEN 0\n    ELSE 1\nEND AS sort_order\nFROM ${CURDatabase}.${CURTable}\nWHERE \n$__timeFilter(line_item_usage_start_date)\nAND line_item_usage_account_id = '${AccountId}'\nAND product_region_code != ''\nORDER BY\nsort_order,\nproduct_region_code"
        },
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query"
      },
      {
        "current": {},
        "description": "Input the name of your autoscaling group.",
        "hide": 0,
        "label": "ASG Name",
        "name": "ASGName",
        "options": [],
        "query": "",
        "skipUrlSync": false,
        "type": "textbox"
      },
      {
        "current": {},
        "datasource": {
          "type": "grafana-athena-datasource",
          "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
        },
        "definition": "",
        "description": "Load balancers observed in the CUR for the account/region during the selected time period. ",
        "hide": 0,
        "includeAll": false,
        "label": "Load Balancer",
        "multi": false,
        "name": "LBName",
        "options": [],
        "query": {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "format": 1,
          "rawSQL": "SELECT \n  DISTINCT(line_item_resource_id)\nFROM ${CURDatabase}.${CURTable}\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AWSELB'\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] = '${TagValue}';\n\n"
        },
        "refresh": 1,
        "regex": "/loadbalancer/(.*)$/",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query"
      },
      {
        "current": {
          "selected": true,
          "text": "hour",
          "value": "hour"
        },
        "description": "Select the Granularity for CUR data points",
        "hide": 0,
        "includeAll": false,
        "label": "CUR Granularity",
        "multi": false,
        "name": "CURGranularity",
        "options": [
          {
            "selected": true,
            "text": "hour",
            "value": "hour"
          },
          {
            "selected": false,
            "text": "day",
            "value": "day"
          },
          {
            "selected": false,
            "text": "week",
            "value": "week"
          },
          {
            "selected": false,
            "text": "month",
            "value": "month"
          }
        ],
        "query": "hour,day,week,month",
        "queryValue": "",
        "skipUrlSync": false,
        "type": "custom"
      },
      {
        "current": {
          "selected": true,
          "text": "3600",
          "value": "3600"
        },
        "description": "Select the Granularity for CloudWatch data points in seconds.  ",
        "hide": 0,
        "includeAll": false,
        "label": "CloudWatch Granularity(s)",
        "multi": false,
        "name": "CWGranularity",
        "options": [
          {
            "selected": false,
            "text": "300",
            "value": "300"
          },
          {
            "selected": true,
            "text": "3600",
            "value": "3600"
          },
          {
            "selected": false,
            "text": "86400",
            "value": "86400"
          },
          {
            "selected": false,
            "text": "604800",
            "value": "604800"
          },
          {
            "selected": false,
            "text": "2592000",
            "value": "2592000"
          }
        ],
        "query": "300,3600,86400,604800,2592000",
        "queryValue": "",
        "skipUrlSync": false,
        "type": "custom"
      },
      {
        "current": {},
        "datasource": {
          "type": "grafana-athena-datasource",
          "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
        },
        "definition": "",
        "description": "Tag Key extracted from CUR and observed in the time period selected.",
        "hide": 0,
        "includeAll": false,
        "label": "Tag Key",
        "multi": false,
        "name": "TagKey",
        "options": [],
        "query": {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "format": 1,
          "rawSQL": "WITH all_keys AS (\n  SELECT ARRAY_DISTINCT(ARRAY_AGG(key)) AS unique_keys\n  FROM ${CURDatabase}.${CURTable}\n  CROSS JOIN UNNEST(MAP_KEYS(resource_tags)) AS t(key)\n  WHERE \n  $__timeFilter(line_item_usage_start_date)\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n)\n\nSELECT key AS unique_key\nFROM all_keys\nCROSS JOIN UNNEST(unique_keys) AS t(key);"
        },
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query"
      },
      {
        "current": {},
        "datasource": {
          "type": "grafana-athena-datasource",
          "uid": "${DS_GRAFANA-DASHBOARDS-ATHENA}"
        },
        "definition": "",
        "hide": 0,
        "includeAll": false,
        "label": "Tag Value",
        "multi": false,
        "name": "TagValue",
        "options": [],
        "query": {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "format": 1,
          "rawSQL": "SELECT \n  resource_tags['${TagKey}'] AS tag_value,\n  COUNT(*) AS count\nFROM ${CURDatabase}.${CURTable}\nWHERE \n  $__timeFilter(line_item_usage_start_date)\n  AND line_item_usage_account_id = '${AccountId}'\n  AND product_region_code = '${Region}'\n  AND resource_tags['${TagKey}'] IS NOT NULL\nGROUP BY resource_tags['${TagKey}']\nORDER BY count DESC;"
        },
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query"
      }
    ]
  },
  "time": {
    "from": "2025-08-01T04:00:00.000Z",
    "to": "2025-08-03T03:59:59.000Z"
  },
  "timepicker": {},
  "timezone": "",
  "title": "Autoscaling Dashboard",
  "uid": "G9CQ3OpIzfda23g",
  "version": 145,
  "weekStart": ""
}